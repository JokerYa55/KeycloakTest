<!DOCTYPE html>
<html>
    <head>
        <title>Личный кабинет</title>
        
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="style.css">
        <script src="jquery-1.8.3.js"></script>
        <script>
            var userInfo;
            var accessToken;


            function userAuth()
            {
                var accessToken;
                var username = $("#nameId").val();
                var password = $("#passwordId").val();
                $.post("http://192.168.1.150:8080/auth/realms/master/protocol/openid-connect/token", {client_id: "admin-cli", password: password, username: username, grant_type: "password"})
                        .done(function (data) {
                            console.log(data);
                            accessToken = data;
                            console.log(accessToken);

                            $.ajax({
                                url: "http://192.168.1.150:8080/auth/admin/realms/master/users",
                                data: {username: "vasil"},
                                type: "GET",
                                beforeSend: function (xhr) {
                                    xhr.setRequestHeader('Authorization', "Bearer " + accessToken.access_token);
                                },
                                success: function (data) {
                                    console.log(data);
                                    userInfo = data[0];
                                    console.log(userInfo);
                                    $("#idId").val(userInfo.id);
                                    $("#nameId").val(userInfo.username);
                                }
                            });

                        });

            }

        </script>    

    </head>
    <body>
        <div id="header">шапка сайта</div>
        <div id="menu">
            <form action="http://192.168.1.150:8080/auth/realms/master/protocol/openid-connect/token" method="POST">                
                <input type="hidden" name="client_id" value="admin-cli"/>
                <input id="nameId" type="text" name="username" value="vasil"/>
                <input id="passwordId" type="text" name="password" value="123"/>
                <input type="hidden" name="grant_type" value="password"/>
                 <input type="button" value="Test" onclick="userAuth();"/>
                
                <input id="idId" type="text" value=" ">
            </form>

           

        </div>
        <div id="content">контент</div>
        <div id="footer">низ сайта</div>
    </body>



</body>
</html>
